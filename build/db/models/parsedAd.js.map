{"version":3,"sources":["db/models/parsedAd.js"],"names":[],"mappings":";;AAAA;;;;AACA;;AACA;;;;;;AAGA,IAAM,aAAa,UAAnB;;AAEA,IAAM,iBAAiB,IAAI,mBAAS,MAAb,CAAoB;AACvC,UAAM,MADiC;AAEvC,YAAQ,MAF+B;AAGvC,gBAAY;AACR,aAAK,MADG;AAER,eAAO,MAFC;AAGR,cAAM,MAHE;AAIR,iBAAS,MAJD;AAKR,0BAAkB,MALV;AAMR,eAAO;AANC,KAH2B;AAWvC,UAAM;AACF,mBAAW,IADT,E;AAEF,iBAAS,MAFP;AAGF,oBAAY;AAHV;AAXiC,CAApB,CAAvB;;AAkBA,eAAe,OAAf,CAAuB,UAAvB,GAAoC,SAAS,UAAT,CAAoB,IAApB,EAA0B,MAA1B,EAAkC,IAAlC,EAAwC;;AAExE,QAAM,gBAAgB,KAAK,GAAL,CAAS,UAAC,EAAD,EAAO;AAClC,eAAO;AACH,kBAAM,GAAG,EADN;AAEH,oBAAQ,MAFL;AAGH,wBAAY;AACR,qBAAK,GAAG,GADA;AAER,uBAAO,GAAG,KAFF;AAGR,sBAAM,GAAG,IAHD;AAIR,yBAAS,GAAG,OAJJ;AAKR,kCAAkB,GAAG,gBALb;AAMR,uBAAO,GAAG;AANF,aAHT;AAWH,kBAAM;AACF,2BAAW,IADT;AAEF,yBAAS,GAAG,IAAH,CAAQ,OAFf;AAGF,4BAAY,GAAG,IAAH,CAAQ;AAHlB;AAXH,SAAP;AAiBH,KAlBqB,CAAtB;;AAoBA,SAAK,MAAL,CAAY,aAAZ,EAA2B,UAAC,KAAD,EAAU;AACjC,yBAAO,KAAP,CAAa,gCAAb;AACA,iBAAS,iBAAO,KAAP,CAAa,oCAAb,EAAmD,EAAC,YAAD,EAAnD,CAAT;AACH,KAHD;AAIH,CA1BD;;AA4BA,eAAe,OAAf,CAAuB,UAAvB,GAAoC,UAAS,IAAT,EAAe,MAAf,EAAuB,IAAvB,EAA4B,CAE/D,CAFD;;AAMA,mBAAS,KAAT,CAAe,UAAf,EAA2B,cAA3B","file":"db/models/parsedAd.js","sourcesContent":["import mongoose from 'mongoose'\r\nimport { isArray } from 'lodash'\r\nimport logger from '../../../logging/logger'\r\n\r\n\r\nconst MODEL_NAME = 'ParsedAd';\r\n\r\nconst ParsedAdSchema = new mongoose.Schema({\r\n    adId: String,\r\n    source: String,\r\n    parsedData: {\r\n        uri: String,\r\n        title: String,\r\n        city: String,\r\n        company: String,\r\n        companySecondary: String,\r\n        views: Number\r\n    },\r\n    meta: {\r\n        parseDate: Date, // should be same value for all entries on single crawl\r\n        adIndex: Number,\r\n        pageNumber: Number\r\n    }\r\n});\r\n\r\nParsedAdSchema.statics.insertDocs = function insertDocs(data, source, date) {\r\n\r\n    const dataForInsert = data.map((ad)=> {\r\n        return {\r\n            adId: ad.id,\r\n            source: source,\r\n            parsedData: {\r\n                uri: ad.uri,\r\n                title: ad.title,\r\n                city: ad.city,\r\n                company: ad.company,\r\n                companySecondary: ad.companySecondary,\r\n                views: ad.views\r\n            },\r\n            meta: {\r\n                parseDate: date,\r\n                adIndex: ad.meta.adIndex,\r\n                pageNumber: ad.meta.pageNumber\r\n            }\r\n        }\r\n    });\r\n\r\n    this.create(dataForInsert, (error)=> {\r\n        logger.debug('successfully created parsedads');\r\n        error && logger.error('Error  while creating new ParsedAd', {error});\r\n    })\r\n};\r\n\r\nParsedAdSchema.statics.insertMany = function(data, source, date){\r\n\r\n};\r\n\r\n\r\n\r\nmongoose.model(MODEL_NAME, ParsedAdSchema);"],"sourceRoot":"/source/"}